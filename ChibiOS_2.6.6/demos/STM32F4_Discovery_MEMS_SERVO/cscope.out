cscope 15 $HOME/work_STM/ChibiOS_2.6.6/demos/ARMCM4-STM32F407-DISCOVERY-MEMS               0000036818
	@/home/volodymyr/work_STM/ChibiOS_2.6.6/demos/ARMCM4-STM32F407-DISCOVERY-MEMS/chconf.h

28 #i‚de‡
_CHCONF_H_


29 
	#_CHCONF_H_


	)

43 #i‡!
deföed
(
CH_FREQUENCY
Ë|| deföed(
__DOXYGEN__
)

44 
	#CH_FREQUENCY
 1000

	)

58 #i‡!
deföed
(
CH_TIME_QUANTUM
Ë|| deföed(
__DOXYGEN__
)

59 
	#CH_TIME_QUANTUM
 20

	)

73 #i‡!
deföed
(
CH_MEMCORE_SIZE
Ë|| deföed(
__DOXYGEN__
)

74 
	#CH_MEMCORE_SIZE
 0

	)

90 #i‡!
deföed
(
CH_NO_IDLE_THREAD
Ë|| deföed(
__DOXYGEN__
)

91 
	#CH_NO_IDLE_THREAD
 
FALSE


	)

111 #i‡!
deföed
(
CH_OPTIMIZE_SPEED
Ë|| deföed(
__DOXYGEN__
)

112 
	#CH_OPTIMIZE_SPEED
 
TRUE


	)

130 #i‡!
deföed
(
CH_USE_REGISTRY
Ë|| deföed(
__DOXYGEN__
)

131 
	#CH_USE_REGISTRY
 
TRUE


	)

141 #i‡!
deföed
(
CH_USE_WAITEXIT
Ë|| deföed(
__DOXYGEN__
)

142 
	#CH_USE_WAITEXIT
 
TRUE


	)

151 #i‡!
deföed
(
CH_USE_SEMAPHORES
Ë|| deföed(
__DOXYGEN__
)

152 
	#CH_USE_SEMAPHORES
 
TRUE


	)

163 #i‡!
deföed
(
CH_USE_SEMAPHORES_PRIORITY
Ë|| deföed(
__DOXYGEN__
)

164 
	#CH_USE_SEMAPHORES_PRIORITY
 
FALSE


	)

175 #i‡!
deföed
(
CH_USE_SEMSW
Ë|| deföed(
__DOXYGEN__
)

176 
	#CH_USE_SEMSW
 
TRUE


	)

185 #i‡!
deföed
(
CH_USE_MUTEXES
Ë|| deföed(
__DOXYGEN__
)

186 
	#CH_USE_MUTEXES
 
TRUE


	)

197 #i‡!
deföed
(
CH_USE_CONDVARS
Ë|| deföed(
__DOXYGEN__
)

198 
	#CH_USE_CONDVARS
 
TRUE


	)

209 #i‡!
deföed
(
CH_USE_CONDVARS_TIMEOUT
Ë|| deföed(
__DOXYGEN__
)

210 
	#CH_USE_CONDVARS_TIMEOUT
 
TRUE


	)

219 #i‡!
deföed
(
CH_USE_EVENTS
Ë|| deföed(
__DOXYGEN__
)

220 
	#CH_USE_EVENTS
 
TRUE


	)

231 #i‡!
deföed
(
CH_USE_EVENTS_TIMEOUT
Ë|| deföed(
__DOXYGEN__
)

232 
	#CH_USE_EVENTS_TIMEOUT
 
TRUE


	)

242 #i‡!
deföed
(
CH_USE_MESSAGES
Ë|| deföed(
__DOXYGEN__
)

243 
	#CH_USE_MESSAGES
 
TRUE


	)

254 #i‡!
deföed
(
CH_USE_MESSAGES_PRIORITY
Ë|| deföed(
__DOXYGEN__
)

255 
	#CH_USE_MESSAGES_PRIORITY
 
FALSE


	)

266 #i‡!
deföed
(
CH_USE_MAILBOXES
Ë|| deföed(
__DOXYGEN__
)

267 
	#CH_USE_MAILBOXES
 
TRUE


	)

276 #i‡!
deföed
(
CH_USE_QUEUES
Ë|| deföed(
__DOXYGEN__
)

277 
	#CH_USE_QUEUES
 
TRUE


	)

287 #i‡!
deföed
(
CH_USE_MEMCORE
Ë|| deföed(
__DOXYGEN__
)

288 
	#CH_USE_MEMCORE
 
TRUE


	)

301 #i‡!
deföed
(
CH_USE_HEAP
Ë|| deföed(
__DOXYGEN__
)

302 
	#CH_USE_HEAP
 
TRUE


	)

315 #i‡!
deföed
(
CH_USE_MALLOC_HEAP
Ë|| deföed(
__DOXYGEN__
)

316 
	#CH_USE_MALLOC_HEAP
 
FALSE


	)

326 #i‡!
deföed
(
CH_USE_MEMPOOLS
Ë|| deföed(
__DOXYGEN__
)

327 
	#CH_USE_MEMPOOLS
 
TRUE


	)

339 #i‡!
deföed
(
CH_USE_DYNAMIC
Ë|| deföed(
__DOXYGEN__
)

340 
	#CH_USE_DYNAMIC
 
TRUE


	)

359 #i‡!
deföed
(
CH_DBG_SYSTEM_STATE_CHECK
Ë|| deföed(
__DOXYGEN__
)

360 
	#CH_DBG_SYSTEM_STATE_CHECK
 
FALSE


	)

370 #i‡!
deföed
(
CH_DBG_ENABLE_CHECKS
Ë|| deföed(
__DOXYGEN__
)

371 
	#CH_DBG_ENABLE_CHECKS
 
FALSE


	)

382 #i‡!
deföed
(
CH_DBG_ENABLE_ASSERTS
Ë|| deföed(
__DOXYGEN__
)

383 
	#CH_DBG_ENABLE_ASSERTS
 
FALSE


	)

393 #i‡!
deföed
(
CH_DBG_ENABLE_TRACE
Ë|| deföed(
__DOXYGEN__
)

394 
	#CH_DBG_ENABLE_TRACE
 
FALSE


	)

407 #i‡!
deföed
(
CH_DBG_ENABLE_STACK_CHECK
Ë|| deföed(
__DOXYGEN__
)

408 
	#CH_DBG_ENABLE_STACK_CHECK
 
FALSE


	)

419 #i‡!
deföed
(
CH_DBG_FILL_THREADS
Ë|| deföed(
__DOXYGEN__
)

420 
	#CH_DBG_FILL_THREADS
 
FALSE


	)

432 #i‡!
deföed
(
CH_DBG_THREADS_PROFILING
Ë|| deföed(
__DOXYGEN__
)

433 
	#CH_DBG_THREADS_PROFILING
 
TRUE


	)

449 #i‡!
deföed
(
THREAD_EXT_FIELDS
Ë|| deföed(
__DOXYGEN__
)

450 
	#THREAD_EXT_FIELDS
 \

	)

461 #i‡!
deföed
(
THREAD_EXT_INIT_HOOK
Ë|| deföed(
__DOXYGEN__
)

462 
	#THREAD_EXT_INIT_HOOK
(
ç
Ë{ \

	)

475 #i‡!
deföed
(
THREAD_EXT_EXIT_HOOK
Ë|| deföed(
__DOXYGEN__
)

476 
	#THREAD_EXT_EXIT_HOOK
(
ç
Ë{ \

	)

485 #i‡!
deföed
(
THREAD_CONTEXT_SWITCH_HOOK
Ë|| deföed(
__DOXYGEN__
)

486 
	#THREAD_CONTEXT_SWITCH_HOOK
(
¡p
, 
Ÿp
Ë{ \

	)

495 #i‡!
deföed
(
IDLE_LOOP_HOOK
Ë|| deföed(
__DOXYGEN__
)

496 
	#IDLE_LOOP_HOOK
(Ë{ \

	)

506 #i‡!
deföed
(
SYSTEM_TICK_EVENT_HOOK
Ë|| deföed(
__DOXYGEN__
)

507 
	#SYSTEM_TICK_EVENT_HOOK
(Ë{ \

	)

517 #i‡!
deföed
(
SYSTEM_HALT_HOOK
Ë|| deföed(
__DOXYGEN__
)

518 
	#SYSTEM_HALT_HOOK
(Ë{ \

	)

	@/home/volodymyr/work_STM/ChibiOS_2.6.6/demos/ARMCM4-STM32F407-DISCOVERY-MEMS/halconf.h

28 #i‚de‡
_HALCONF_H_


29 
	#_HALCONF_H_


	)

31 
	~"mcuc⁄f.h
"

36 #i‡!
deföed
(
HAL_USE_TM
Ë|| deföed(
__DOXYGEN__
)

37 
	#HAL_USE_TM
 
FALSE


	)

43 #i‡!
deföed
(
HAL_USE_PAL
Ë|| deföed(
__DOXYGEN__
)

44 
	#HAL_USE_PAL
 
TRUE


	)

50 #i‡!
deföed
(
HAL_USE_ADC
Ë|| deföed(
__DOXYGEN__
)

51 
	#HAL_USE_ADC
 
FALSE


	)

57 #i‡!
deföed
(
HAL_USE_CAN
Ë|| deföed(
__DOXYGEN__
)

58 
	#HAL_USE_CAN
 
FALSE


	)

64 #i‡!
deföed
(
HAL_USE_EXT
Ë|| deföed(
__DOXYGEN__
)

65 
	#HAL_USE_EXT
 
FALSE


	)

71 #i‡!
deföed
(
HAL_USE_GPT
Ë|| deföed(
__DOXYGEN__
)

72 
	#HAL_USE_GPT
 
FALSE


	)

78 #i‡!
deföed
(
HAL_USE_I2C
Ë|| deföed(
__DOXYGEN__
)

79 
	#HAL_USE_I2C
 
FALSE


	)

85 #i‡!
deföed
(
HAL_USE_ICU
Ë|| deföed(
__DOXYGEN__
)

86 
	#HAL_USE_ICU
 
FALSE


	)

92 #i‡!
deföed
(
HAL_USE_MAC
Ë|| deföed(
__DOXYGEN__
)

93 
	#HAL_USE_MAC
 
FALSE


	)

99 #i‡!
deföed
(
HAL_USE_MMC_SPI
Ë|| deföed(
__DOXYGEN__
)

100 
	#HAL_USE_MMC_SPI
 
FALSE


	)

106 #i‡!
deföed
(
HAL_USE_PWM
Ë|| deföed(
__DOXYGEN__
)

107 
	#HAL_USE_PWM
 
TRUE


	)

113 #i‡!
deföed
(
HAL_USE_RTC
Ë|| deföed(
__DOXYGEN__
)

114 
	#HAL_USE_RTC
 
FALSE


	)

120 #i‡!
deföed
(
HAL_USE_SDC
Ë|| deföed(
__DOXYGEN__
)

121 
	#HAL_USE_SDC
 
FALSE


	)

127 #i‡!
deföed
(
HAL_USE_SERIAL
Ë|| deföed(
__DOXYGEN__
)

128 
	#HAL_USE_SERIAL
 
TRUE


	)

134 #i‡!
deföed
(
HAL_USE_SERIAL_USB
Ë|| deföed(
__DOXYGEN__
)

135 
	#HAL_USE_SERIAL_USB
 
TRUE


	)

141 #i‡!
deföed
(
HAL_USE_SPI
Ë|| deföed(
__DOXYGEN__
)

142 
	#HAL_USE_SPI
 
TRUE


	)

148 #i‡!
deföed
(
HAL_USE_UART
Ë|| deföed(
__DOXYGEN__
)

149 
	#HAL_USE_UART
 
FALSE


	)

155 #i‡!
deföed
(
HAL_USE_USB
Ë|| deföed(
__DOXYGEN__
)

156 
	#HAL_USE_USB
 
TRUE


	)

167 #i‡!
deföed
(
ADC_USE_WAIT
Ë|| deföed(
__DOXYGEN__
)

168 
	#ADC_USE_WAIT
 
TRUE


	)

175 #i‡!
deföed
(
ADC_USE_MUTUAL_EXCLUSION
Ë|| deföed(
__DOXYGEN__
)

176 
	#ADC_USE_MUTUAL_EXCLUSION
 
TRUE


	)

186 #i‡!
deföed
(
CAN_USE_SLEEP_MODE
Ë|| deföed(
__DOXYGEN__
)

187 
	#CAN_USE_SLEEP_MODE
 
TRUE


	)

197 #i‡!
deföed
(
I2C_USE_MUTUAL_EXCLUSION
Ë|| deföed(
__DOXYGEN__
)

198 
	#I2C_USE_MUTUAL_EXCLUSION
 
TRUE


	)

208 #i‡!
deföed
(
MAC_USE_ZERO_COPY
Ë|| deföed(
__DOXYGEN__
)

209 
	#MAC_USE_ZERO_COPY
 
FALSE


	)

215 #i‡!
deföed
(
MAC_USE_EVENTS
Ë|| deföed(
__DOXYGEN__
)

216 
	#MAC_USE_EVENTS
 
TRUE


	)

231 #i‡!
deföed
(
MMC_NICE_WAITING
Ë|| deföed(
__DOXYGEN__
)

232 
	#MMC_NICE_WAITING
 
TRUE


	)

243 #i‡!
deföed
(
SDC_INIT_RETRY
Ë|| deföed(
__DOXYGEN__
)

244 
	#SDC_INIT_RETRY
 100

	)

252 #i‡!
deföed
(
SDC_MMC_SUPPORT
Ë|| deföed(
__DOXYGEN__
)

253 
	#SDC_MMC_SUPPORT
 
FALSE


	)

262 #i‡!
deföed
(
SDC_NICE_WAITING
Ë|| deföed(
__DOXYGEN__
)

263 
	#SDC_NICE_WAITING
 
TRUE


	)

275 #i‡!
deföed
(
SERIAL_DEFAULT_BITRATE
Ë|| deföed(
__DOXYGEN__
)

276 
	#SERIAL_DEFAULT_BITRATE
 38400

	)

286 #i‡!
deföed
(
SERIAL_BUFFERS_SIZE
Ë|| deföed(
__DOXYGEN__
)

287 
	#SERIAL_BUFFERS_SIZE
 16

	)

298 #i‡!
deföed
(
SPI_USE_WAIT
Ë|| deföed(
__DOXYGEN__
)

299 
	#SPI_USE_WAIT
 
TRUE


	)

306 #i‡!
deföed
(
SPI_USE_MUTUAL_EXCLUSION
Ë|| deföed(
__DOXYGEN__
)

307 
	#SPI_USE_MUTUAL_EXCLUSION
 
TRUE


	)

	@/home/volodymyr/work_STM/ChibiOS_2.6.6/demos/ARMCM4-STM32F407-DISCOVERY-MEMS/main.c

17 
	~"ch.h
"

18 
	~"hÆ.h
"

19 
	~"ã°.h
"

21 
	~"ch¥ötf.h
"

22 
	~"shñl.h
"

23 
	~"lis302dl.h
"

25 
	~"usbcfg.h
"

28 
SîülUSBDrivî
 
	gSDU1
;

34 
	#SHELL_WA_SIZE
 
	`THD_WA_SIZE
(2048)

	)

35 
	#TEST_WA_SIZE
 
	`THD_WA_SIZE
(256)

	)

37 
	$cmd_mem
(
Ba£SequítülSåóm
 *
chp
, 
¨gc
, *
¨gv
[]) {

38 
size_t
 
n
, 
size
;

40 ()
¨gv
;

41 i‡(
¨gc
 > 0) {

42 
	`ch¥ötf
(
chp
, "Usage: mem\r\n");

45 
n
 = 
	`chHópSètus
(
NULL
, &
size
);

46 
	`ch¥ötf
(
chp
, "c‹ê‰ì mem‹y : %u byãs\r\n", 
	`chC‹eSètus
());

47 
	`ch¥ötf
(
chp
, "hó∞‰agmít† : %u\r\n", 
n
);

48 
	`ch¥ötf
(
chp
, "hó∞‰ìÅŸÆ : %u byãs\r\n", 
size
);

49 
	}
}

51 
	$cmd_thªads
(
Ba£SequítülSåóm
 *
chp
, 
¨gc
, *
¨gv
[]) {

52 c⁄° *
°©es
[] = {
THD_STATE_NAMES
};

53 
Thªad
 *
ç
;

55 ()
¨gv
;

56 i‡(
¨gc
 > 0) {

57 
	`ch¥ötf
(
chp
, "Usage:Åhreads\r\n");

60 
	`ch¥ötf
(
chp
, "áddr stackÖrioÑefs stateÅime\r\n");

61 
ç
 = 
	`chRegFú°Thªad
();

63 
	`ch¥ötf
(
chp
, "%.8lx %.8lx %4lu %4lu %9s %lu\r\n",

64 (
uöt32_t
)
ç
, (uöt32_tÈp->
p_˘x
.
r13
,

65 (
uöt32_t
)
ç
->
p_¥io
, (uöt32_t)—p->
p_ªfs
 - 1),

66 
°©es
[
ç
->
p_°©e
], (
uöt32_t
Èp->
p_time
);

67 
ç
 = 
	`chRegNextThªad
(tp);

68 } 
ç
 !
NULL
);

69 
	}
}

71 
	$cmd_ã°
(
Ba£SequítülSåóm
 *
chp
, 
¨gc
, *
¨gv
[]) {

72 
Thªad
 *
ç
;

74 ()
¨gv
;

75 i‡(
¨gc
 > 0) {

76 
	`ch¥ötf
(
chp
, "Usage:Åest\r\n");

79 
ç
 = 
	`chThdCª©eFromHóp
(
NULL
, 
TEST_WA_SIZE
, 
	`chThdGëPri‹ôy
(),

80 
Te°Thªad
, 
chp
);

81 i‡(
ç
 =
NULL
) {

82 
	`ch¥ötf
(
chp
, "out of memory\r\n");

85 
	`chThdWaô
(
ç
);

86 
	}
}

88 c⁄° 
ShñlComm™d
 
	gcomm™ds
[] = {

89 {"mem", 
cmd_mem
},

90 {"thªads", 
cmd_thªads
},

91 {"ã°", 
cmd_ã°
},

92 {
NULL
, NULL}

95 c⁄° 
ShñlC⁄fig
 
	gshñl_cfg1
 = {

96 (
Ba£SequítülSåóm
 *)&
SDU1
,

97 
comm™ds


109 c⁄° 
PWMC⁄fig
 
	gpwmcfg
 = {

112 
NULL
,

114 {
PWM_OUTPUT_ACTIVE_HIGH
, 
NULL
},

115 {
PWM_OUTPUT_ACTIVE_HIGH
, 
NULL
},

116 {
PWM_OUTPUT_ACTIVE_HIGH
, 
NULL
},

117 {
PWM_OUTPUT_ACTIVE_HIGH
, 
NULL
}

129 c⁄° 
SPIC⁄fig
 
	g•i1cfg
 = {

130 
NULL
,

132 
GPIOE
,

133 
GPIOE_CS_SPI
,

134 
SPI_CR1_BR_0
 | 
SPI_CR1_BR_1
 | 
SPI_CR1_CPOL
 | 
SPI_CR1_CPHA


142 c⁄° 
SPIC⁄fig
 
	g•i2cfg
 = {

143 
NULL
,

145 
GPIOB
,

154 
WORKING_AREA
(
waThªad1
, 128);

155 
msg_t
 
	$Thªad1
(*
¨g
) {

156 
öt8_t
 
xbuf
[4], 
ybuf
[4];

157 
sy°ime_t
 
time
;

159 ()
¨g
;

160 
	`chRegSëThªadName
("reader");

163 
	`lis302dlWrôeRegi°î
(&
SPID1
, 
LIS302DL_CTRL_REG1
, 0x43);

164 
	`lis302dlWrôeRegi°î
(&
SPID1
, 
LIS302DL_CTRL_REG2
, 0x00);

165 
	`lis302dlWrôeRegi°î
(&
SPID1
, 
LIS302DL_CTRL_REG3
, 0x00);

168 
time
 = 
	`chTimeNow
();

169 
TRUE
) {

170 
öt32_t
 
x
, 
y
;

171 
i
;

174 
i
 = 3; i > 0; i--) {

175 
xbuf
[
i
] = xbuf[i - 1];

176 
ybuf
[
i
] = ybuf[i - 1];

180 
xbuf
[0] = (
öt8_t
)
	`lis302dlRódRegi°î
(&
SPID1
, 
LIS302DL_OUTX
);

181 
ybuf
[0] = (
öt8_t
)
	`lis302dlRódRegi°î
(&
SPID1
, 
LIS302DL_OUTY
);

184 
	`•iSñe˘
(&
SPID2
);

185 
	`•iSíd
(&
SPID2
, 4, 
xbuf
);

186 
	`•iSíd
(&
SPID2
, 4, 
ybuf
);

187 
	`•iUn£À˘
(&
SPID2
);

190 
x
 = ((
öt32_t
)
xbuf
[0] + (int32_t)xbuf[1] +

191 (
öt32_t
)
xbuf
[2] + (int32_t)xbuf[3]) / 4;

192 
y
 = ((
öt32_t
)
ybuf
[0] + (int32_t)ybuf[1] +

193 (
öt32_t
)
ybuf
[2] + (int32_t)ybuf[3]) / 4;

196 i‡(
y
 < 0) {

197 
	`pwmE«bÀCh™√l
(&
PWMD4
, 0, (
pwm˙t_t
)-
y
);

198 
	`pwmE«bÀCh™√l
(&
PWMD4
, 2, (
pwm˙t_t
)0);

201 
	`pwmE«bÀCh™√l
(&
PWMD4
, 2, (
pwm˙t_t
)
y
);

202 
	`pwmE«bÀCh™√l
(&
PWMD4
, 0, (
pwm˙t_t
)0);

204 i‡(
x
 < 0) {

205 
	`pwmE«bÀCh™√l
(&
PWMD4
, 1, (
pwm˙t_t
)-
x
);

206 
	`pwmE«bÀCh™√l
(&
PWMD4
, 3, (
pwm˙t_t
)0);

209 
	`pwmE«bÀCh™√l
(&
PWMD4
, 3, (
pwm˙t_t
)
x
);

210 
	`pwmE«bÀCh™√l
(&
PWMD4
, 1, (
pwm˙t_t
)0);

214 
	`chThdSÀïU¡û
(
time
 +
	`MS2ST
(100));

216 
	}
}

225 
	$maö
() {

226 
Thªad
 *
shñ…p
 = 
NULL
;

235 
	`hÆInô
();

236 
	`chSysInô
();

241 
	`shñlInô
();

246 
	`sduObje˘Inô
(&
SDU1
);

247 
	`sduSèπ
(&
SDU1
, &
£rusbcfg
);

254 
	`usbDisc⁄√˘Bus
(
£rusbcfg
.
usbp
);

255 
	`chThdSÀïMûli£c⁄ds
(1000);

256 
	`usbSèπ
(
£rusbcfg
.
usbp
, &
usbcfg
);

257 
	`usbC⁄√˘Bus
(
£rusbcfg
.
usbp
);

263 
	`sdSèπ
(&
SD2
, 
NULL
);

264 
	`∑lSëPadMode
(
GPIOA
, 2, 
	`PAL_MODE_ALTERNATE
(7));

265 
	`∑lSëPadMode
(
GPIOA
, 3, 
	`PAL_MODE_ALTERNATE
(7));

271 
	`•iSèπ
(&
SPID1
, &
•i1cfg
);

280 
	`•iSèπ
(&
SPID2
, &
•i2cfg
);

281 
	`∑lSëPad
(
GPIOB
, 12);

282 
	`∑lSëPadMode
(
GPIOB
, 12, 
PAL_MODE_OUTPUT_PUSHPULL
 |

283 
PAL_STM32_OSPEED_HIGHEST
);

284 
	`∑lSëPadMode
(
GPIOB
, 13, 
	`PAL_MODE_ALTERNATE
(5) |

285 
PAL_STM32_OSPEED_HIGHEST
);

286 
	`∑lSëPadMode
(
GPIOB
, 14, 
	`PAL_MODE_ALTERNATE
(5));

287 
	`∑lSëPadMode
(
GPIOB
, 15, 
	`PAL_MODE_ALTERNATE
(5) |

288 
PAL_STM32_OSPEED_HIGHEST
);

293 
	`pwmSèπ
(&
PWMD4
, &
pwmcfg
);

294 
	`∑lSëPadMode
(
GPIOD
, 
GPIOD_LED4
, 
	`PAL_MODE_ALTERNATE
(2));

295 
	`∑lSëPadMode
(
GPIOD
, 
GPIOD_LED3
, 
	`PAL_MODE_ALTERNATE
(2));

296 
	`∑lSëPadMode
(
GPIOD
, 
GPIOD_LED5
, 
	`PAL_MODE_ALTERNATE
(2));

297 
	`∑lSëPadMode
(
GPIOD
, 
GPIOD_LED6
, 
	`PAL_MODE_ALTERNATE
(2));

302 
	`chThdCª©eSètic
(
waThªad1
, (waThread1),

303 
NORMALPRIO
 + 10, 
Thªad1
, 
NULL
);

309 
TRUE
) {

310 i‡(!
shñ…p
) {

311 i‡(
SDU1
.
c⁄fig
->
usbp
->
°©e
 =
USB_ACTIVE
) {

313 
shñ…p
 = 
	`shñlCª©e
(&
shñl_cfg1
, 
SHELL_WA_SIZE
, 
NORMALPRIO
);

318 i‡(
	`chThdTîmö©ed
(
shñ…p
)) {

320 
	`chThdRñó£
(
shñ…p
);

321 
shñ…p
 = 
NULL
;

324 
	`chThdSÀïMûli£c⁄ds
(500);

326 
	}
}

	@/home/volodymyr/work_STM/ChibiOS_2.6.6/demos/ARMCM4-STM32F407-DISCOVERY-MEMS/mcuconf.h

31 
	#STM32F4xx_MCUCONF


	)

36 
	#STM32_NO_INIT
 
FALSE


	)

37 
	#STM32_HSI_ENABLED
 
TRUE


	)

38 
	#STM32_LSI_ENABLED
 
TRUE


	)

39 
	#STM32_HSE_ENABLED
 
TRUE


	)

40 
	#STM32_LSE_ENABLED
 
FALSE


	)

41 
	#STM32_CLOCK48_REQUIRED
 
TRUE


	)

42 
	#STM32_SW
 
STM32_SW_PLL


	)

43 
	#STM32_PLLSRC
 
STM32_PLLSRC_HSE


	)

44 
	#STM32_PLLM_VALUE
 8

	)

45 
	#STM32_PLLN_VALUE
 336

	)

46 
	#STM32_PLLP_VALUE
 2

	)

47 
	#STM32_PLLQ_VALUE
 7

	)

48 
	#STM32_HPRE
 
STM32_HPRE_DIV1


	)

49 
	#STM32_PPRE1
 
STM32_PPRE1_DIV4


	)

50 
	#STM32_PPRE2
 
STM32_PPRE2_DIV2


	)

51 
	#STM32_RTCSEL
 
STM32_RTCSEL_LSI


	)

52 
	#STM32_RTCPRE_VALUE
 8

	)

53 
	#STM32_MCO1SEL
 
STM32_MCO1SEL_HSI


	)

54 
	#STM32_MCO1PRE
 
STM32_MCO1PRE_DIV1


	)

55 
	#STM32_MCO2SEL
 
STM32_MCO2SEL_SYSCLK


	)

56 
	#STM32_MCO2PRE
 
STM32_MCO2PRE_DIV5


	)

57 
	#STM32_I2SSRC
 
STM32_I2SSRC_CKIN


	)

58 
	#STM32_PLLI2SN_VALUE
 192

	)

59 
	#STM32_PLLI2SR_VALUE
 5

	)

60 
	#STM32_PVD_ENABLE
 
FALSE


	)

61 
	#STM32_PLS
 
STM32_PLS_LEV0


	)

62 
	#STM32_BKPRAM_ENABLE
 
FALSE


	)

67 
	#STM32_ADC_ADCPRE
 
ADC_CCR_ADCPRE_DIV4


	)

68 
	#STM32_ADC_USE_ADC1
 
FALSE


	)

69 
	#STM32_ADC_USE_ADC2
 
FALSE


	)

70 
	#STM32_ADC_USE_ADC3
 
FALSE


	)

71 
	#STM32_ADC_ADC1_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(2, 4)

	)

72 
	#STM32_ADC_ADC2_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(2, 2)

	)

73 
	#STM32_ADC_ADC3_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(2, 1)

	)

74 
	#STM32_ADC_ADC1_DMA_PRIORITY
 2

	)

75 
	#STM32_ADC_ADC2_DMA_PRIORITY
 2

	)

76 
	#STM32_ADC_ADC3_DMA_PRIORITY
 2

	)

77 
	#STM32_ADC_IRQ_PRIORITY
 6

	)

78 
	#STM32_ADC_ADC1_DMA_IRQ_PRIORITY
 6

	)

79 
	#STM32_ADC_ADC2_DMA_IRQ_PRIORITY
 6

	)

80 
	#STM32_ADC_ADC3_DMA_IRQ_PRIORITY
 6

	)

85 
	#STM32_CAN_USE_CAN1
 
FALSE


	)

86 
	#STM32_CAN_USE_CAN2
 
FALSE


	)

87 
	#STM32_CAN_CAN1_IRQ_PRIORITY
 11

	)

88 
	#STM32_CAN_CAN2_IRQ_PRIORITY
 11

	)

93 
	#STM32_EXT_EXTI0_IRQ_PRIORITY
 6

	)

94 
	#STM32_EXT_EXTI1_IRQ_PRIORITY
 6

	)

95 
	#STM32_EXT_EXTI2_IRQ_PRIORITY
 6

	)

96 
	#STM32_EXT_EXTI3_IRQ_PRIORITY
 6

	)

97 
	#STM32_EXT_EXTI4_IRQ_PRIORITY
 6

	)

98 
	#STM32_EXT_EXTI5_9_IRQ_PRIORITY
 6

	)

99 
	#STM32_EXT_EXTI10_15_IRQ_PRIORITY
 6

	)

100 
	#STM32_EXT_EXTI16_IRQ_PRIORITY
 6

	)

101 
	#STM32_EXT_EXTI17_IRQ_PRIORITY
 15

	)

102 
	#STM32_EXT_EXTI18_IRQ_PRIORITY
 6

	)

103 
	#STM32_EXT_EXTI19_IRQ_PRIORITY
 6

	)

104 
	#STM32_EXT_EXTI20_IRQ_PRIORITY
 6

	)

105 
	#STM32_EXT_EXTI21_IRQ_PRIORITY
 15

	)

106 
	#STM32_EXT_EXTI22_IRQ_PRIORITY
 15

	)

111 
	#STM32_GPT_USE_TIM1
 
FALSE


	)

112 
	#STM32_GPT_USE_TIM2
 
FALSE


	)

113 
	#STM32_GPT_USE_TIM3
 
FALSE


	)

114 
	#STM32_GPT_USE_TIM4
 
FALSE


	)

115 
	#STM32_GPT_USE_TIM5
 
FALSE


	)

116 
	#STM32_GPT_USE_TIM6
 
FALSE


	)

117 
	#STM32_GPT_USE_TIM7
 
FALSE


	)

118 
	#STM32_GPT_USE_TIM8
 
FALSE


	)

119 
	#STM32_GPT_USE_TIM9
 
FALSE


	)

120 
	#STM32_GPT_USE_TIM11
 
FALSE


	)

121 
	#STM32_GPT_USE_TIM12
 
FALSE


	)

122 
	#STM32_GPT_USE_TIM14
 
FALSE


	)

123 
	#STM32_GPT_TIM1_IRQ_PRIORITY
 7

	)

124 
	#STM32_GPT_TIM2_IRQ_PRIORITY
 7

	)

125 
	#STM32_GPT_TIM3_IRQ_PRIORITY
 7

	)

126 
	#STM32_GPT_TIM4_IRQ_PRIORITY
 7

	)

127 
	#STM32_GPT_TIM5_IRQ_PRIORITY
 7

	)

128 
	#STM32_GPT_TIM6_IRQ_PRIORITY
 7

	)

129 
	#STM32_GPT_TIM7_IRQ_PRIORITY
 7

	)

130 
	#STM32_GPT_TIM8_IRQ_PRIORITY
 7

	)

131 
	#STM32_GPT_TIM9_IRQ_PRIORITY
 7

	)

132 
	#STM32_GPT_TIM11_IRQ_PRIORITY
 7

	)

133 
	#STM32_GPT_TIM12_IRQ_PRIORITY
 7

	)

134 
	#STM32_GPT_TIM14_IRQ_PRIORITY
 7

	)

139 
	#STM32_I2C_USE_I2C1
 
FALSE


	)

140 
	#STM32_I2C_USE_I2C2
 
FALSE


	)

141 
	#STM32_I2C_USE_I2C3
 
FALSE


	)

142 
	#STM32_I2C_I2C1_RX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(1, 0)

	)

143 
	#STM32_I2C_I2C1_TX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(1, 6)

	)

144 
	#STM32_I2C_I2C2_RX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(1, 2)

	)

145 
	#STM32_I2C_I2C2_TX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(1, 7)

	)

146 
	#STM32_I2C_I2C3_RX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(1, 2)

	)

147 
	#STM32_I2C_I2C3_TX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(1, 4)

	)

148 
	#STM32_I2C_I2C1_IRQ_PRIORITY
 5

	)

149 
	#STM32_I2C_I2C2_IRQ_PRIORITY
 5

	)

150 
	#STM32_I2C_I2C3_IRQ_PRIORITY
 5

	)

151 
	#STM32_I2C_I2C1_DMA_PRIORITY
 3

	)

152 
	#STM32_I2C_I2C2_DMA_PRIORITY
 3

	)

153 
	#STM32_I2C_I2C3_DMA_PRIORITY
 3

	)

154 
	#STM32_I2C_I2C1_DMA_ERROR_HOOK
(Ë
	`chSysHÆt
()

	)

155 
	#STM32_I2C_I2C2_DMA_ERROR_HOOK
(Ë
	`chSysHÆt
()

	)

156 
	#STM32_I2C_I2C3_DMA_ERROR_HOOK
(Ë
	`chSysHÆt
()

	)

161 
	#STM32_ICU_USE_TIM1
 
FALSE


	)

162 
	#STM32_ICU_USE_TIM2
 
FALSE


	)

163 
	#STM32_ICU_USE_TIM3
 
FALSE


	)

164 
	#STM32_ICU_USE_TIM4
 
FALSE


	)

165 
	#STM32_ICU_USE_TIM5
 
FALSE


	)

166 
	#STM32_ICU_USE_TIM8
 
FALSE


	)

167 
	#STM32_ICU_USE_TIM9
 
FALSE


	)

168 
	#STM32_ICU_TIM1_IRQ_PRIORITY
 7

	)

169 
	#STM32_ICU_TIM2_IRQ_PRIORITY
 7

	)

170 
	#STM32_ICU_TIM3_IRQ_PRIORITY
 7

	)

171 
	#STM32_ICU_TIM4_IRQ_PRIORITY
 7

	)

172 
	#STM32_ICU_TIM5_IRQ_PRIORITY
 7

	)

173 
	#STM32_ICU_TIM8_IRQ_PRIORITY
 7

	)

174 
	#STM32_ICU_TIM9_IRQ_PRIORITY
 7

	)

179 
	#STM32_MAC_TRANSMIT_BUFFERS
 2

	)

180 
	#STM32_MAC_RECEIVE_BUFFERS
 4

	)

181 
	#STM32_MAC_BUFFERS_SIZE
 1522

	)

182 
	#STM32_MAC_PHY_TIMEOUT
 100

	)

183 
	#STM32_MAC_ETH1_CHANGE_PHY_STATE
 
TRUE


	)

184 
	#STM32_MAC_ETH1_IRQ_PRIORITY
 13

	)

185 
	#STM32_MAC_IP_CHECKSUM_OFFLOAD
 0

	)

190 
	#STM32_PWM_USE_ADVANCED
 
FALSE


	)

191 
	#STM32_PWM_USE_TIM1
 
FALSE


	)

192 
	#STM32_PWM_USE_TIM2
 
FALSE


	)

193 
	#STM32_PWM_USE_TIM3
 
FALSE


	)

194 
	#STM32_PWM_USE_TIM4
 
TRUE


	)

195 
	#STM32_PWM_USE_TIM5
 
FALSE


	)

196 
	#STM32_PWM_USE_TIM8
 
FALSE


	)

197 
	#STM32_PWM_USE_TIM9
 
FALSE


	)

198 
	#STM32_PWM_TIM1_IRQ_PRIORITY
 7

	)

199 
	#STM32_PWM_TIM2_IRQ_PRIORITY
 7

	)

200 
	#STM32_PWM_TIM3_IRQ_PRIORITY
 7

	)

201 
	#STM32_PWM_TIM4_IRQ_PRIORITY
 7

	)

202 
	#STM32_PWM_TIM5_IRQ_PRIORITY
 7

	)

203 
	#STM32_PWM_TIM8_IRQ_PRIORITY
 7

	)

204 
	#STM32_PWM_TIM9_IRQ_PRIORITY
 7

	)

209 
	#STM32_SERIAL_USE_USART1
 
FALSE


	)

210 
	#STM32_SERIAL_USE_USART2
 
TRUE


	)

211 
	#STM32_SERIAL_USE_USART3
 
FALSE


	)

212 
	#STM32_SERIAL_USE_UART4
 
FALSE


	)

213 
	#STM32_SERIAL_USE_UART5
 
FALSE


	)

214 
	#STM32_SERIAL_USE_USART6
 
FALSE


	)

215 
	#STM32_SERIAL_USART1_PRIORITY
 12

	)

216 
	#STM32_SERIAL_USART2_PRIORITY
 12

	)

217 
	#STM32_SERIAL_USART3_PRIORITY
 12

	)

218 
	#STM32_SERIAL_UART4_PRIORITY
 12

	)

219 
	#STM32_SERIAL_UART5_PRIORITY
 12

	)

220 
	#STM32_SERIAL_USART6_PRIORITY
 12

	)

225 
	#STM32_SPI_USE_SPI1
 
TRUE


	)

226 
	#STM32_SPI_USE_SPI2
 
TRUE


	)

227 
	#STM32_SPI_USE_SPI3
 
FALSE


	)

228 
	#STM32_SPI_SPI1_RX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(2, 0)

	)

229 
	#STM32_SPI_SPI1_TX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(2, 3)

	)

230 
	#STM32_SPI_SPI2_RX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(1, 3)

	)

231 
	#STM32_SPI_SPI2_TX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(1, 4)

	)

232 
	#STM32_SPI_SPI3_RX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(1, 0)

	)

233 
	#STM32_SPI_SPI3_TX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(1, 7)

	)

234 
	#STM32_SPI_SPI1_DMA_PRIORITY
 1

	)

235 
	#STM32_SPI_SPI2_DMA_PRIORITY
 1

	)

236 
	#STM32_SPI_SPI3_DMA_PRIORITY
 1

	)

237 
	#STM32_SPI_SPI1_IRQ_PRIORITY
 10

	)

238 
	#STM32_SPI_SPI2_IRQ_PRIORITY
 10

	)

239 
	#STM32_SPI_SPI3_IRQ_PRIORITY
 10

	)

240 
	#STM32_SPI_DMA_ERROR_HOOK
(
•ù
Ë
	`chSysHÆt
()

	)

245 
	#STM32_UART_USE_USART1
 
FALSE


	)

246 
	#STM32_UART_USE_USART2
 
FALSE


	)

247 
	#STM32_UART_USE_USART3
 
FALSE


	)

248 
	#STM32_UART_USE_UART4
 
FALSE


	)

249 
	#STM32_UART_USE_UART5
 
FALSE


	)

250 
	#STM32_UART_USE_USART6
 
FALSE


	)

251 
	#STM32_UART_USART1_RX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(2, 5)

	)

252 
	#STM32_UART_USART1_TX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(2, 7)

	)

253 
	#STM32_UART_USART2_RX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(1, 5)

	)

254 
	#STM32_UART_USART2_TX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(1, 6)

	)

255 
	#STM32_UART_USART3_RX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(1, 1)

	)

256 
	#STM32_UART_USART3_TX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(1, 3)

	)

257 
	#STM32_UART_UART4_RX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(1, 2)

	)

258 
	#STM32_UART_UART4_TX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(1, 4)

	)

259 
	#STM32_UART_UART5_RX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(1, 0)

	)

260 
	#STM32_UART_UART5_TX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(1, 7)

	)

261 
	#STM32_UART_USART6_RX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(2, 2)

	)

262 
	#STM32_UART_USART6_TX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(2, 7)

	)

263 
	#STM32_UART_USART1_IRQ_PRIORITY
 12

	)

264 
	#STM32_UART_USART2_IRQ_PRIORITY
 12

	)

265 
	#STM32_UART_USART3_IRQ_PRIORITY
 12

	)

266 
	#STM32_UART_UART4_IRQ_PRIORITY
 12

	)

267 
	#STM32_UART_UART5_IRQ_PRIORITY
 12

	)

268 
	#STM32_UART_USART6_IRQ_PRIORITY
 12

	)

269 
	#STM32_UART_USART1_DMA_PRIORITY
 0

	)

270 
	#STM32_UART_USART2_DMA_PRIORITY
 0

	)

271 
	#STM32_UART_USART3_DMA_PRIORITY
 0

	)

272 
	#STM32_UART_UART4_DMA_PRIORITY
 0

	)

273 
	#STM32_UART_UART5_DMA_PRIORITY
 0

	)

274 
	#STM32_UART_USART6_DMA_PRIORITY
 0

	)

275 
	#STM32_UART_DMA_ERROR_HOOK
(
u¨ç
Ë
	`chSysHÆt
()

	)

280 
	#STM32_USB_USE_OTG1
 
TRUE


	)

281 
	#STM32_USB_USE_OTG2
 
FALSE


	)

282 
	#STM32_USB_OTG1_IRQ_PRIORITY
 14

	)

283 
	#STM32_USB_OTG2_IRQ_PRIORITY
 14

	)

284 
	#STM32_USB_OTG1_RX_FIFO_SIZE
 512

	)

285 
	#STM32_USB_OTG2_RX_FIFO_SIZE
 1024

	)

286 
	#STM32_USB_OTG_THREAD_PRIO
 
LOWPRIO


	)

287 
	#STM32_USB_OTG_THREAD_STACK_SIZE
 128

	)

288 
	#STM32_USB_OTGFIFO_FILL_BASEPRI
 0

	)

	@/home/volodymyr/work_STM/ChibiOS_2.6.6/demos/ARMCM4-STM32F407-DISCOVERY-MEMS/usbcfg.c

17 
	~"ch.h
"

18 
	~"hÆ.h
"

23 
	#USBD1_DATA_REQUEST_EP
 1

	)

24 
	#USBD1_DATA_AVAILABLE_EP
 1

	)

25 
	#USBD1_INTERRUPT_REQUEST_EP
 2

	)

30 c⁄° 
uöt8_t
 
	gvcom_devi˚_des¸ùt‹_d©a
[18] = {

31 
USB_DESC_DEVICE
 (0x0110,

48 c⁄° 
USBDes¸ùt‹
 
	gvcom_devi˚_des¸ùt‹
 = {

49  
vcom_devi˚_des¸ùt‹_d©a
,

50 
vcom_devi˚_des¸ùt‹_d©a


54 c⁄° 
uöt8_t
 
	gvcom_c⁄figuøti⁄_des¸ùt‹_d©a
[67] = {

56 
USB_DESC_CONFIGURATION
(67,

63 
USB_DESC_INTERFACE
 (0x00,

75 
USB_DESC_BYTE
 (5),

76 
USB_DESC_BYTE
 (0x24),

77 
USB_DESC_BYTE
 (0x00),

79 
USB_DESC_BCD
 (0x0110),

81 
USB_DESC_BYTE
 (5),

82 
USB_DESC_BYTE
 (0x24),

83 
USB_DESC_BYTE
 (0x01),

85 
USB_DESC_BYTE
 (0x00),

86 
USB_DESC_BYTE
 (0x01),

88 
USB_DESC_BYTE
 (4),

89 
USB_DESC_BYTE
 (0x24),

90 
USB_DESC_BYTE
 (0x02),

92 
USB_DESC_BYTE
 (0x02),

94 
USB_DESC_BYTE
 (5),

95 
USB_DESC_BYTE
 (0x24),

96 
USB_DESC_BYTE
 (0x06),

98 
USB_DESC_BYTE
 (0x00),

100 
USB_DESC_BYTE
 (0x01),

103 
USB_DESC_ENDPOINT
 (
USBD1_INTERRUPT_REQUEST_EP
|0x80,

108 
USB_DESC_INTERFACE
 (0x01,

119 
USB_DESC_ENDPOINT
 (
USBD1_DATA_AVAILABLE_EP
,

124 
USB_DESC_ENDPOINT
 (
USBD1_DATA_REQUEST_EP
|0x80,

133 c⁄° 
USBDes¸ùt‹
 
	gvcom_c⁄figuøti⁄_des¸ùt‹
 = {

134  
vcom_c⁄figuøti⁄_des¸ùt‹_d©a
,

135 
vcom_c⁄figuøti⁄_des¸ùt‹_d©a


141 c⁄° 
uöt8_t
 
	gvcom_°rög0
[] = {

142 
USB_DESC_BYTE
(4),

143 
USB_DESC_BYTE
(
USB_DESCRIPTOR_STRING
),

144 
USB_DESC_WORD
(0x0409)

150 c⁄° 
uöt8_t
 
	gvcom_°rög1
[] = {

151 
USB_DESC_BYTE
(38),

152 
USB_DESC_BYTE
(
USB_DESCRIPTOR_STRING
),

161 c⁄° 
uöt8_t
 
	gvcom_°rög2
[] = {

162 
USB_DESC_BYTE
(56),

163 
USB_DESC_BYTE
(
USB_DESCRIPTOR_STRING
),

173 c⁄° 
uöt8_t
 
	gvcom_°rög3
[] = {

174 
USB_DESC_BYTE
(8),

175 
USB_DESC_BYTE
(
USB_DESCRIPTOR_STRING
),

176 '0' + 
CH_KERNEL_MAJOR
, 0,

177 '0' + 
CH_KERNEL_MINOR
, 0,

178 '0' + 
CH_KERNEL_PATCH
, 0

184 c⁄° 
USBDes¸ùt‹
 
	gvcom_°rögs
[] = {

185 { 
vcom_°rög0
, vcom_string0},

186 { 
vcom_°rög1
, vcom_string1},

187 { 
vcom_°rög2
, vcom_string2},

188 { 
vcom_°rög3
, vcom_string3}

195 c⁄° 
USBDes¸ùt‹
 *
	$gë_des¸ùt‹
(
USBDrivî
 *
usbp
,

196 
uöt8_t
 
dty≥
,

197 
uöt8_t
 
dödex
,

198 
uöt16_t
 
œng
) {

200 ()
usbp
;

201 ()
œng
;

202 
dty≥
) {

203 
USB_DESCRIPTOR_DEVICE
:

204  &
vcom_devi˚_des¸ùt‹
;

205 
USB_DESCRIPTOR_CONFIGURATION
:

206  &
vcom_c⁄figuøti⁄_des¸ùt‹
;

207 
USB_DESCRIPTOR_STRING
:

208 i‡(
dödex
 < 4)

209  &
vcom_°rögs
[
dödex
];

211  
NULL
;

212 
	}
}

217 
USBInEndpoötSèã
 
	gï1ö°©e
;

222 
USBOutEndpoötSèã
 
	gï1out°©e
;

227 c⁄° 
USBEndpoötC⁄fig
 
	gï1c⁄fig
 = {

228 
USB_EP_MODE_TYPE_BULK
,

229 
NULL
,

230 
sduD©aTønsmôãd
,

231 
sduD©aRe˚ived
,

234 &
ï1ö°©e
,

235 &
ï1out°©e
,

237 
NULL


243 
USBInEndpoötSèã
 
	gï2ö°©e
;

248 c⁄° 
USBEndpoötC⁄fig
 
	gï2c⁄fig
 = {

249 
USB_EP_MODE_TYPE_INTR
,

250 
NULL
,

251 
sduI¡îru±Tønsmôãd
,

252 
NULL
,

255 &
ï2ö°©e
,

256 
NULL
,

258 
NULL


264 
	$usb_evít
(
USBDrivî
 *
usbp
, 
usbevít_t
 
evít
) {

265 
SîülUSBDrivî
 
SDU1
;

267 
evít
) {

268 
USB_EVENT_RESET
:

270 
USB_EVENT_ADDRESS
:

272 
USB_EVENT_CONFIGURED
:

273 
	`chSysLockFromI§
();

278 
	`usbInôEndpoötI
(
usbp
, 
USBD1_DATA_REQUEST_EP
, &
ï1c⁄fig
);

279 
	`usbInôEndpoötI
(
usbp
, 
USBD1_INTERRUPT_REQUEST_EP
, &
ï2c⁄fig
);

282 
	`sduC⁄figuªHookI
(&
SDU1
);

284 
	`chSysU∆ockFromI§
();

286 
USB_EVENT_SUSPEND
:

288 
USB_EVENT_WAKEUP
:

290 
USB_EVENT_STALLED
:

294 
	}
}

299 c⁄° 
USBC⁄fig
 
	gusbcfg
 = {

300 
usb_evít
,

301 
gë_des¸ùt‹
,

302 
sduReque°sHook
,

303 
NULL


309 c⁄° 
SîülUSBC⁄fig
 
	g£rusbcfg
 = {

310 &
USBD1
,

311 
USBD1_DATA_REQUEST_EP
,

312 
USBD1_DATA_AVAILABLE_EP
,

313 
USBD1_INTERRUPT_REQUEST_EP


	@/home/volodymyr/work_STM/ChibiOS_2.6.6/demos/ARMCM4-STM32F407-DISCOVERY-MEMS/usbcfg.h

17 #i‚de‡
_USBCFG_H_


18 
	#_USBCFG_H_


	)

20 c⁄° 
USBC⁄fig
 
usbcfg
;

21 
SîülUSBC⁄fig
 
£rusbcfg
;

	@mcuconf.h

31 
	#STM32F4xx_MCUCONF


	)

36 
	#STM32_NO_INIT
 
FALSE


	)

37 
	#STM32_HSI_ENABLED
 
TRUE


	)

38 
	#STM32_LSI_ENABLED
 
TRUE


	)

39 
	#STM32_HSE_ENABLED
 
TRUE


	)

40 
	#STM32_LSE_ENABLED
 
FALSE


	)

41 
	#STM32_CLOCK48_REQUIRED
 
TRUE


	)

42 
	#STM32_SW
 
STM32_SW_PLL


	)

43 
	#STM32_PLLSRC
 
STM32_PLLSRC_HSE


	)

44 
	#STM32_PLLM_VALUE
 8

	)

45 
	#STM32_PLLN_VALUE
 336

	)

46 
	#STM32_PLLP_VALUE
 2

	)

47 
	#STM32_PLLQ_VALUE
 7

	)

48 
	#STM32_HPRE
 
STM32_HPRE_DIV1


	)

49 
	#STM32_PPRE1
 
STM32_PPRE1_DIV4


	)

50 
	#STM32_PPRE2
 
STM32_PPRE2_DIV2


	)

51 
	#STM32_RTCSEL
 
STM32_RTCSEL_LSI


	)

52 
	#STM32_RTCPRE_VALUE
 8

	)

53 
	#STM32_MCO1SEL
 
STM32_MCO1SEL_HSI


	)

54 
	#STM32_MCO1PRE
 
STM32_MCO1PRE_DIV1


	)

55 
	#STM32_MCO2SEL
 
STM32_MCO2SEL_SYSCLK


	)

56 
	#STM32_MCO2PRE
 
STM32_MCO2PRE_DIV5


	)

57 
	#STM32_I2SSRC
 
STM32_I2SSRC_CKIN


	)

58 
	#STM32_PLLI2SN_VALUE
 192

	)

59 
	#STM32_PLLI2SR_VALUE
 5

	)

60 
	#STM32_PVD_ENABLE
 
FALSE


	)

61 
	#STM32_PLS
 
STM32_PLS_LEV0


	)

62 
	#STM32_BKPRAM_ENABLE
 
FALSE


	)

67 
	#STM32_ADC_ADCPRE
 
ADC_CCR_ADCPRE_DIV4


	)

68 
	#STM32_ADC_USE_ADC1
 
FALSE


	)

69 
	#STM32_ADC_USE_ADC2
 
FALSE


	)

70 
	#STM32_ADC_USE_ADC3
 
FALSE


	)

71 
	#STM32_ADC_ADC1_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(2, 4)

	)

72 
	#STM32_ADC_ADC2_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(2, 2)

	)

73 
	#STM32_ADC_ADC3_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(2, 1)

	)

74 
	#STM32_ADC_ADC1_DMA_PRIORITY
 2

	)

75 
	#STM32_ADC_ADC2_DMA_PRIORITY
 2

	)

76 
	#STM32_ADC_ADC3_DMA_PRIORITY
 2

	)

77 
	#STM32_ADC_IRQ_PRIORITY
 6

	)

78 
	#STM32_ADC_ADC1_DMA_IRQ_PRIORITY
 6

	)

79 
	#STM32_ADC_ADC2_DMA_IRQ_PRIORITY
 6

	)

80 
	#STM32_ADC_ADC3_DMA_IRQ_PRIORITY
 6

	)

85 
	#STM32_CAN_USE_CAN1
 
FALSE


	)

86 
	#STM32_CAN_USE_CAN2
 
FALSE


	)

87 
	#STM32_CAN_CAN1_IRQ_PRIORITY
 11

	)

88 
	#STM32_CAN_CAN2_IRQ_PRIORITY
 11

	)

93 
	#STM32_EXT_EXTI0_IRQ_PRIORITY
 6

	)

94 
	#STM32_EXT_EXTI1_IRQ_PRIORITY
 6

	)

95 
	#STM32_EXT_EXTI2_IRQ_PRIORITY
 6

	)

96 
	#STM32_EXT_EXTI3_IRQ_PRIORITY
 6

	)

97 
	#STM32_EXT_EXTI4_IRQ_PRIORITY
 6

	)

98 
	#STM32_EXT_EXTI5_9_IRQ_PRIORITY
 6

	)

99 
	#STM32_EXT_EXTI10_15_IRQ_PRIORITY
 6

	)

100 
	#STM32_EXT_EXTI16_IRQ_PRIORITY
 6

	)

101 
	#STM32_EXT_EXTI17_IRQ_PRIORITY
 15

	)

102 
	#STM32_EXT_EXTI18_IRQ_PRIORITY
 6

	)

103 
	#STM32_EXT_EXTI19_IRQ_PRIORITY
 6

	)

104 
	#STM32_EXT_EXTI20_IRQ_PRIORITY
 6

	)

105 
	#STM32_EXT_EXTI21_IRQ_PRIORITY
 15

	)

106 
	#STM32_EXT_EXTI22_IRQ_PRIORITY
 15

	)

111 
	#STM32_GPT_USE_TIM1
 
FALSE


	)

112 
	#STM32_GPT_USE_TIM2
 
FALSE


	)

113 
	#STM32_GPT_USE_TIM3
 
FALSE


	)

114 
	#STM32_GPT_USE_TIM4
 
FALSE


	)

115 
	#STM32_GPT_USE_TIM5
 
FALSE


	)

116 
	#STM32_GPT_USE_TIM6
 
FALSE


	)

117 
	#STM32_GPT_USE_TIM7
 
FALSE


	)

118 
	#STM32_GPT_USE_TIM8
 
FALSE


	)

119 
	#STM32_GPT_USE_TIM9
 
FALSE


	)

120 
	#STM32_GPT_USE_TIM11
 
FALSE


	)

121 
	#STM32_GPT_USE_TIM12
 
FALSE


	)

122 
	#STM32_GPT_USE_TIM14
 
FALSE


	)

123 
	#STM32_GPT_TIM1_IRQ_PRIORITY
 7

	)

124 
	#STM32_GPT_TIM2_IRQ_PRIORITY
 7

	)

125 
	#STM32_GPT_TIM3_IRQ_PRIORITY
 7

	)

126 
	#STM32_GPT_TIM4_IRQ_PRIORITY
 7

	)

127 
	#STM32_GPT_TIM5_IRQ_PRIORITY
 7

	)

128 
	#STM32_GPT_TIM6_IRQ_PRIORITY
 7

	)

129 
	#STM32_GPT_TIM7_IRQ_PRIORITY
 7

	)

130 
	#STM32_GPT_TIM8_IRQ_PRIORITY
 7

	)

131 
	#STM32_GPT_TIM9_IRQ_PRIORITY
 7

	)

132 
	#STM32_GPT_TIM11_IRQ_PRIORITY
 7

	)

133 
	#STM32_GPT_TIM12_IRQ_PRIORITY
 7

	)

134 
	#STM32_GPT_TIM14_IRQ_PRIORITY
 7

	)

139 
	#STM32_I2C_USE_I2C1
 
FALSE


	)

140 
	#STM32_I2C_USE_I2C2
 
FALSE


	)

141 
	#STM32_I2C_USE_I2C3
 
FALSE


	)

142 
	#STM32_I2C_I2C1_RX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(1, 0)

	)

143 
	#STM32_I2C_I2C1_TX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(1, 6)

	)

144 
	#STM32_I2C_I2C2_RX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(1, 2)

	)

145 
	#STM32_I2C_I2C2_TX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(1, 7)

	)

146 
	#STM32_I2C_I2C3_RX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(1, 2)

	)

147 
	#STM32_I2C_I2C3_TX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(1, 4)

	)

148 
	#STM32_I2C_I2C1_IRQ_PRIORITY
 5

	)

149 
	#STM32_I2C_I2C2_IRQ_PRIORITY
 5

	)

150 
	#STM32_I2C_I2C3_IRQ_PRIORITY
 5

	)

151 
	#STM32_I2C_I2C1_DMA_PRIORITY
 3

	)

152 
	#STM32_I2C_I2C2_DMA_PRIORITY
 3

	)

153 
	#STM32_I2C_I2C3_DMA_PRIORITY
 3

	)

154 
	#STM32_I2C_I2C1_DMA_ERROR_HOOK
(Ë
	`chSysHÆt
()

	)

155 
	#STM32_I2C_I2C2_DMA_ERROR_HOOK
(Ë
	`chSysHÆt
()

	)

156 
	#STM32_I2C_I2C3_DMA_ERROR_HOOK
(Ë
	`chSysHÆt
()

	)

161 
	#STM32_ICU_USE_TIM1
 
FALSE


	)

162 
	#STM32_ICU_USE_TIM2
 
FALSE


	)

163 
	#STM32_ICU_USE_TIM3
 
FALSE


	)

164 
	#STM32_ICU_USE_TIM4
 
FALSE


	)

165 
	#STM32_ICU_USE_TIM5
 
FALSE


	)

166 
	#STM32_ICU_USE_TIM8
 
FALSE


	)

167 
	#STM32_ICU_USE_TIM9
 
FALSE


	)

168 
	#STM32_ICU_TIM1_IRQ_PRIORITY
 7

	)

169 
	#STM32_ICU_TIM2_IRQ_PRIORITY
 7

	)

170 
	#STM32_ICU_TIM3_IRQ_PRIORITY
 7

	)

171 
	#STM32_ICU_TIM4_IRQ_PRIORITY
 7

	)

172 
	#STM32_ICU_TIM5_IRQ_PRIORITY
 7

	)

173 
	#STM32_ICU_TIM8_IRQ_PRIORITY
 7

	)

174 
	#STM32_ICU_TIM9_IRQ_PRIORITY
 7

	)

179 
	#STM32_MAC_TRANSMIT_BUFFERS
 2

	)

180 
	#STM32_MAC_RECEIVE_BUFFERS
 4

	)

181 
	#STM32_MAC_BUFFERS_SIZE
 1522

	)

182 
	#STM32_MAC_PHY_TIMEOUT
 100

	)

183 
	#STM32_MAC_ETH1_CHANGE_PHY_STATE
 
TRUE


	)

184 
	#STM32_MAC_ETH1_IRQ_PRIORITY
 13

	)

185 
	#STM32_MAC_IP_CHECKSUM_OFFLOAD
 0

	)

190 
	#STM32_PWM_USE_ADVANCED
 
FALSE


	)

191 
	#STM32_PWM_USE_TIM1
 
FALSE


	)

192 
	#STM32_PWM_USE_TIM2
 
FALSE


	)

193 
	#STM32_PWM_USE_TIM3
 
FALSE


	)

194 
	#STM32_PWM_USE_TIM4
 
TRUE


	)

195 
	#STM32_PWM_USE_TIM5
 
FALSE


	)

196 
	#STM32_PWM_USE_TIM8
 
FALSE


	)

197 
	#STM32_PWM_USE_TIM9
 
FALSE


	)

198 
	#STM32_PWM_TIM1_IRQ_PRIORITY
 7

	)

199 
	#STM32_PWM_TIM2_IRQ_PRIORITY
 7

	)

200 
	#STM32_PWM_TIM3_IRQ_PRIORITY
 7

	)

201 
	#STM32_PWM_TIM4_IRQ_PRIORITY
 7

	)

202 
	#STM32_PWM_TIM5_IRQ_PRIORITY
 7

	)

203 
	#STM32_PWM_TIM8_IRQ_PRIORITY
 7

	)

204 
	#STM32_PWM_TIM9_IRQ_PRIORITY
 7

	)

209 
	#STM32_SERIAL_USE_USART1
 
FALSE


	)

210 
	#STM32_SERIAL_USE_USART2
 
TRUE


	)

211 
	#STM32_SERIAL_USE_USART3
 
FALSE


	)

212 
	#STM32_SERIAL_USE_UART4
 
FALSE


	)

213 
	#STM32_SERIAL_USE_UART5
 
FALSE


	)

214 
	#STM32_SERIAL_USE_USART6
 
FALSE


	)

215 
	#STM32_SERIAL_USART1_PRIORITY
 12

	)

216 
	#STM32_SERIAL_USART2_PRIORITY
 12

	)

217 
	#STM32_SERIAL_USART3_PRIORITY
 12

	)

218 
	#STM32_SERIAL_UART4_PRIORITY
 12

	)

219 
	#STM32_SERIAL_UART5_PRIORITY
 12

	)

220 
	#STM32_SERIAL_USART6_PRIORITY
 12

	)

225 
	#STM32_SPI_USE_SPI1
 
TRUE


	)

226 
	#STM32_SPI_USE_SPI2
 
TRUE


	)

227 
	#STM32_SPI_USE_SPI3
 
FALSE


	)

228 
	#STM32_SPI_SPI1_RX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(2, 0)

	)

229 
	#STM32_SPI_SPI1_TX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(2, 3)

	)

230 
	#STM32_SPI_SPI2_RX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(1, 3)

	)

231 
	#STM32_SPI_SPI2_TX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(1, 4)

	)

232 
	#STM32_SPI_SPI3_RX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(1, 0)

	)

233 
	#STM32_SPI_SPI3_TX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(1, 7)

	)

234 
	#STM32_SPI_SPI1_DMA_PRIORITY
 1

	)

235 
	#STM32_SPI_SPI2_DMA_PRIORITY
 1

	)

236 
	#STM32_SPI_SPI3_DMA_PRIORITY
 1

	)

237 
	#STM32_SPI_SPI1_IRQ_PRIORITY
 10

	)

238 
	#STM32_SPI_SPI2_IRQ_PRIORITY
 10

	)

239 
	#STM32_SPI_SPI3_IRQ_PRIORITY
 10

	)

240 
	#STM32_SPI_DMA_ERROR_HOOK
(
•ù
Ë
	`chSysHÆt
()

	)

245 
	#STM32_UART_USE_USART1
 
FALSE


	)

246 
	#STM32_UART_USE_USART2
 
FALSE


	)

247 
	#STM32_UART_USE_USART3
 
FALSE


	)

248 
	#STM32_UART_USE_UART4
 
FALSE


	)

249 
	#STM32_UART_USE_UART5
 
FALSE


	)

250 
	#STM32_UART_USE_USART6
 
FALSE


	)

251 
	#STM32_UART_USART1_RX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(2, 5)

	)

252 
	#STM32_UART_USART1_TX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(2, 7)

	)

253 
	#STM32_UART_USART2_RX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(1, 5)

	)

254 
	#STM32_UART_USART2_TX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(1, 6)

	)

255 
	#STM32_UART_USART3_RX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(1, 1)

	)

256 
	#STM32_UART_USART3_TX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(1, 3)

	)

257 
	#STM32_UART_UART4_RX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(1, 2)

	)

258 
	#STM32_UART_UART4_TX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(1, 4)

	)

259 
	#STM32_UART_UART5_RX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(1, 0)

	)

260 
	#STM32_UART_UART5_TX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(1, 7)

	)

261 
	#STM32_UART_USART6_RX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(2, 2)

	)

262 
	#STM32_UART_USART6_TX_DMA_STREAM
 
	`STM32_DMA_STREAM_ID
(2, 7)

	)

263 
	#STM32_UART_USART1_IRQ_PRIORITY
 12

	)

264 
	#STM32_UART_USART2_IRQ_PRIORITY
 12

	)

265 
	#STM32_UART_USART3_IRQ_PRIORITY
 12

	)

266 
	#STM32_UART_UART4_IRQ_PRIORITY
 12

	)

267 
	#STM32_UART_UART5_IRQ_PRIORITY
 12

	)

268 
	#STM32_UART_USART6_IRQ_PRIORITY
 12

	)

269 
	#STM32_UART_USART1_DMA_PRIORITY
 0

	)

270 
	#STM32_UART_USART2_DMA_PRIORITY
 0

	)

271 
	#STM32_UART_USART3_DMA_PRIORITY
 0

	)

272 
	#STM32_UART_UART4_DMA_PRIORITY
 0

	)

273 
	#STM32_UART_UART5_DMA_PRIORITY
 0

	)

274 
	#STM32_UART_USART6_DMA_PRIORITY
 0

	)

275 
	#STM32_UART_DMA_ERROR_HOOK
(
u¨ç
Ë
	`chSysHÆt
()

	)

280 
	#STM32_USB_USE_OTG1
 
TRUE


	)

281 
	#STM32_USB_USE_OTG2
 
FALSE


	)

282 
	#STM32_USB_OTG1_IRQ_PRIORITY
 14

	)

283 
	#STM32_USB_OTG2_IRQ_PRIORITY
 14

	)

284 
	#STM32_USB_OTG1_RX_FIFO_SIZE
 512

	)

285 
	#STM32_USB_OTG2_RX_FIFO_SIZE
 1024

	)

286 
	#STM32_USB_OTG_THREAD_PRIO
 
LOWPRIO


	)

287 
	#STM32_USB_OTG_THREAD_STACK_SIZE
 128

	)

288 
	#STM32_USB_OTGFIFO_FILL_BASEPRI
 0

	)

	@usbcfg.h

17 #i‚de‡
_USBCFG_H_


18 
	#_USBCFG_H_


	)

20 c⁄° 
USBC⁄fig
 
usbcfg
;

21 
SîülUSBC⁄fig
 
£rusbcfg
;

	@
1
.
1
/usr/include
8
535
/home/volodymyr/work_STM/ChibiOS_2.6.6/demos/ARMCM4-STM32F407-DISCOVERY-MEMS/chconf.h
/home/volodymyr/work_STM/ChibiOS_2.6.6/demos/ARMCM4-STM32F407-DISCOVERY-MEMS/halconf.h
/home/volodymyr/work_STM/ChibiOS_2.6.6/demos/ARMCM4-STM32F407-DISCOVERY-MEMS/main.c
/home/volodymyr/work_STM/ChibiOS_2.6.6/demos/ARMCM4-STM32F407-DISCOVERY-MEMS/mcuconf.h
/home/volodymyr/work_STM/ChibiOS_2.6.6/demos/ARMCM4-STM32F407-DISCOVERY-MEMS/usbcfg.c
/home/volodymyr/work_STM/ChibiOS_2.6.6/demos/ARMCM4-STM32F407-DISCOVERY-MEMS/usbcfg.h
mcuconf.h
usbcfg.h
